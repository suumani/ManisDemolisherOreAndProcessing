# Mani's Demolisher Ore And Processing — 仕様書（spec v0.0.1）

本書は Mani's Demolisher Ore And Processing の **設計意図・仕様・合意事項** を記録する。  
README や ModPortal に載せない「決定事項」「判断基準」「仕様の優先順位」を保持することを目的とする。

---

## 0. 目的と非目的

### 0.1 目的（Purpose）
- ボスデモリッシャー撃破を起点に「報酬・生産・UPS改善」コンテンツを提供する
- 武器追加ではなく、生産構造・物流・圧縮によるエンドコンテンツを提供する
- 周回・厳選・運ゲーを強制せず、「ライン構築」を主目的にする

### 0.2 非目的（Non-goals）
- 武器での直接強化や戦闘能力の上積みを主目的としない
- 周回前提の設計にしない
- 液体・中間素材の種類を無制限に増やさない（管理可能な範囲に抑える）

---

## 1. Mod の位置づけ

### 1.1 依存関係（必須）
- Manis_lib（共通処理）
- Manis_definitions（デモリッシャー定義）

### 1.2 依存関係（任意）
- Mani's Boss Demolisher  
  ※ 導入されている場合、上位デモリン鉱（高速／巨大／キング）の自然入手が可能になる  
  ※ 未導入の場合、本 Mod は「通常デモリン鉱を中心としたライン」に限定され、上位デモリン鉱を要求する要素は **利用できない（意図的）**  
  ※ したがって本 Mod は “完全成立” を目標にしない（上位鉱石はボス Mod による拡張要素である）

### 1.3 役割
- 「撃破の報酬」ではなく「工場が軽くなる／構造が洗練される」ことを最大報酬とする

---

## 2. デモリン鉱系列（確定）

### 2.1 鉱石の種類
- デモリン鉱（基本）
- 高速デモリン鉱（speedstar）
- 巨大デモリン鉱（gigantic）
- キングデモリン鉱（king）

### 2.2 ドロップ方針
- 通常／高速／巨大：確率ドロップ
- キング：100% ドロップ
- 周回強制なし（増殖・循環で供給可能）

---

## 3. デモリッシャーの名残（Remains）処理仕様

本 Mod では、デモリッシャー撃破時に生成される「名残」エンティティの  
採掘結果（minable.results）を data-final-fixes 段階で上書きする。

### 3.1 技術的背景
- Space Age のデモリッシャーは `segmented-unit` として定義されている
- 「corpse」は通常の `corpse` prototype ではなく、`dying_trigger_effect` によって `create-entity` される  
  “採掘可能な岩石系エンティティ” である
- そのため、本 Mod では以下の手順で名残を特定する：  
  1. デモリッシャー（segmented-unit）の `dying_trigger_effect` を解析  
  2. `create-entity` に指定された entity_name を名残として取得  
  3. 対応する prototype の `minable.results` を上書き

### 3.2 競合・将来変更ポリシー（暫定）
- ※ 本 Mod は「最後に評価された `create-entity` を名残とみなす」ことを **現在の基本方針** とする  
- ※ 他 Mod や将来の Space Age 変更により `dying_trigger_effect` の構造が変わった場合、  
  名残の特定方法は将来変更されうる（本 spec の固定要件ではない）

---

## 4. デモリッシャー名残から得られる鉱石

デモリッシャーの種類・サイズ・派生系統に応じて、  
名残の採掘結果に含まれる鉱石が異なる。

### 4.1 基本方針
- 通常デモリッシャーからは必ずタングステン鉱石が得られる
- 多くの個体から、少量のデモリン鉱も同時に得られる
- 高位派生（speedstar / gigantic / king）では、対応する上位デモリン鉱が確定で含まれる
- Boss Demolisher Mod が未導入の場合でも、通常デモリン鉱の入手は可能

### 4.2 鉱石含有量（確定）
※ 含有量はデモリッシャー定義名に完全に対応する  
※ 空欄は「含まれない」ことを意味する  
※ 含有量は **デモリッシャーのサイズおよび定義名にのみ依存**し、品質・惑星・ゲーム進行度による補正は行わない

- normal / additional normal 系  
  - タングステン鉱石 + デモリン鉱（サイズに応じた量）

- speedstar 系  
  - タングステン鉱石  
  - デモリン鉱  
  - 高速デモリン鉱

- gigantic 系  
  - タングステン鉱石  
  - デモリン鉱  
  - 巨大デモリン鉱

- crazy-king 系  
  - タングステン鉱石  
  - デモリン鉱  
  - 高速／巨大／キングデモリン鉱（すべて含有）

※ iron-ore / copper-ore は、一部 ALT 系にのみ副次的に含まれる

---

## 5. 加工・生産ライン（確定）

### 5.1 精製設備（色替え）
- デモリン鉱水精製所（原油精製所ベース）
- デモリン鉱遠心分離機（遠心分離機ベース）
- 新規アニメ・モデルなし（色替えのみ）

### 5.2 液体・副産物
- デモリン鉱水溶液
- デモリン廃水
- 既存液体：水／硫酸／フルオロケトン
- 液体種類は意図的に抑制（5種前後）

#### 5.2.1 デモリン廃水の立ち位置
- デモリン廃水は意図的に大量発生する副産物である
- デモリン鉱の循環（回収・増殖）レシピの一部として利用される
- ただし序盤においては **使い勝手の悪い廃棄物** として振る舞うことを狙う  
  （＝処理設計の圧力として機能させる）
- 本 spec 時点では、「廃水を簡単に消すための最終消費レシピ」を主眼に置かない

### 5.3 増殖・循環
- ウラン遠心分離型の 40→41 系増殖
- 廃水を用いた基本デモリン鉱の回収ルート
- 周回ではなくライン構築が主目的

---

## 6. 製錬・物流（確定）

### 6.1 製錬（鋳造炉）
- 各デモリン鉱 + 溶融鉄 / 溶融銅 → 製錬デモリン鉱（等級別）

### 6.2 梱包材（圧縮専用）
- 製錬デモリン鉱 → デモリン梱包材（等級別）
- 用途は圧縮専用（他用途に流用しない）

---

## 7. サイエンスパック圧縮（確定）
- 物流サイエンスパックを圧縮 → 高圧縮 → 超圧縮 → 究極圧縮
- 圧縮パックは研究不可。必ず展開して通常サイエンスに戻す
- 圧縮の目的：輸送・保管・UPS改善
- ※ 圧縮サイエンスは宇宙輸送・ロケット輸送を前提とした設計とする

---

## 8. ボスサイエンス（確定）

### 8.1 生成条件
- デモリン鉱水溶液 + デモリン鉱系列
- 二系統：  
  - 卵ルート（軽量・生物的）  
  - 木ルート（重量・工業的／グレバ非依存）  
  - 木ルートは序盤〜中盤向けの補助的ルートとして位置づける  
  - 高効率な最終生産は卵ルートを前提とする

### 8.2 等級効率
- デモリン鉱：1
- 高速：3
- 巨大：10
- キング：30

---

## 9. 設計思想（合意事項）
- 本 Mod は「デモリッシャーを倒さなければ進まない」設計にはしない
- 通常デモリッシャーの撃破のみで、最低限のデモリン鉱循環が成立する
- 周回・厳選・運ゲーを強制しない
- 武器追加を目的としない
- 「工場が軽くなる」「構造が洗練される」ことが最大報酬
- UPS・物流・宇宙輸送が主戦場

---

## 10. 本 spec の扱い
- 本書は README および ModPortal の記述より優先される
- 実装と乖離が生じた場合、実装を仕様とみなすか spec を更新するかを明示的に判断する

---

## 11. 実装コメント方針（運用ルール）
- 本 spec に含まれる「技術的背景」「競合ポリシー」など、README/ModPortal に載せない情報は、  
  実装ファイル先頭のヘッダコメント（module header）にも要点を転記してよい  
  （特に data-final-fixes で prototype を上書きする処理は、理由と判断基準をコード側に残す）
